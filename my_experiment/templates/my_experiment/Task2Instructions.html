{% extends "global/Page.html" %}
{% load otree static %}

{% block content %}
  <h3 class="text-center text-primary fw-semibold mb-4">
    {% if player.selected_language == 'it' %}
      Compito 2: Scelte intertemporali
    {% else %}
      Task 2: Intertemporal choice
    {% endif %}
  </h3>
  <hr>

  <p class="fs-5">
    {% if player.selected_language == 'it' %}
      Nel secondo compito, ti verrà chiesto di completare <strong>5 decisioni</strong>.
      Per ciascuna decisione (dalla 1 alla 5), ti verrà chiesto di allocare una somma di denaro tra due date di pagamento:
    {% else %}
      For the second task, you will be faced with <strong>5 decisions</strong>.
      For each decision (1 through 5), you are asked to allocate a sum of money between two payment dates:
    {% endif %}
  </p>

  <ul class="fs-5">
    <li>
      {% if player.selected_language == 'it' %}
        <strong>Presente</strong> (immediatamente)
      {% else %}
        <strong>Earlier</strong> (right now)
      {% endif %}
    </li>
    <li>
      {% if player.selected_language == 'it' %}
        <strong>Futuro</strong> (tra 4 settimane) <!--TODO: modificare time delay?-->
      {% else %}
        <strong>Later</strong> (in 4 weeks)
      {% endif %}
    </li>
  </ul>

  <p class="fs-5">
    {% if player.selected_language == 'it' %}
      Hai un budget di <strong>€ 1.000</strong> in ciascuna decisione, e puoi dividerlo come preferisci.
    {% else %}
      You have a budget of <strong>€ 1.000</strong> in each decision, and you can split it however you like.
    {% endif %}
  </p>
<div class="alert alert-primary rounded">
  <h5>
    {% if player.selected_language == 'it' %}
      Tasso di sconto
    {% else %}
      Discount Rate
    {% endif %}
  </h5>

  <ul class="fs-5">
    <li>
      {% if player.selected_language == 'it' %}
        Ogni Euro allocato a <strong>oggi</strong> vale 1.
        <br>
        <em>Esempio:</em> Se scegli di avere 10 Euro immediatamente, riceverai 10 Euro.
      {% else %}
        Each Euro allocated to <strong>right now</strong> is worth 1.
        <br>
        <em>Example:</em> If you put 10 Euros on right now, you receive 10 Euros.
      {% endif %}
    </li>
    <li>
      {% if player.selected_language == 'it' %}
        Ogni Euro allocato a <strong>tra 4 settimane</strong> vale più di 1.
        <br>
        <em>Esempio:</em> Se il tasso è 1.5 e assegni 10 Euro al futuro, tra 4 settimane riceverai 10 × 1.5 = <strong>15 Euro</strong>.
      {% else %}
        Each Euro allocated to <strong>4 weeks from now</strong> is worth more than 1.
        <br>
        <em>Example:</em> If the rate is 1.5 and you allocate 10 Euros for the future, in 4 weeks you will receive 10 × 1.5 = <strong>15 Euros</strong>.
      {% endif %}
    </li>
  </ul>
</div>
  <p class="fs-5">
    {% if player.selected_language == 'it' %}
      Alla fine dell'esperimento, <strong>una</strong> delle cinque decisioni verrà selezionata casualmente. <!--per il pagamento. Riceverai immediatamente l'importo allocato per oggi, mentre l'importo per il futuro sarà pagato tra 3 settimane.-->
    {% else %}
      At the end of the experiment, <strong>one</strong> of the five decisions will be randomly selected. <!-- for payment. You will immediately receive the amount of money you allocated on today, while the amount allocated for the future will be paid out in 4
       weeks.-->
    {% endif %}
  </p>

  <p class="fs-5 text-danger">
    {% if player.selected_language == 'it' %}
      <strong>Importante:</strong> Devi completare <em>tutte</em> e 5 le decisioni prima di poter procedere.
    {% else %}
      <strong>Important:</strong> You must complete <em>all</em> 5 decisions before you can proceed.
    {% endif %}
  </p>

  <div class="border border-4 border-primary rounded p-3 bg-light mb-4">
    <label for="check_task2" class="fs-5">
      {% if player.selected_language == 'it' %}
        Domanda di comprensione: Se scegli di ricevere €400 immediatamente, quanto puoi assegnare tra 4 settimane? (Rispondi in numeri, senza simboli)
      {% else %}
        Comprehension check: If you allocate €400 to right now, how much can you allocate in 4 weeks? (Answer with numbers only, no symbols)
      {% endif %}
    </label>
    <input
      type="number"
      class="form-control"
      id="check_task2"
      required
      {% if player.selected_language == 'it' %}
        placeholder="Inserisci l'importo rimanente"
      {% else %}
        placeholder="Enter remaining amount"
      {% endif %}
      style="max-width: 300px; font-size: 1.2rem; padding: 0.75rem; border: 2px solid #0d6efd;"
    >
    <div id="task2-error" class="text-danger mt-2" style="display:none;">
      {% if player.selected_language == 'it' %}
        Risposta errata. Per favore, prova di nuovo.
      {% else %}
        Wrong answer. Please try again.
      {% endif %}
    </div>
  </div>
<p class="fs-5">
    {% if player.selected_language == 'it' %}
      Quando sei pronto, clicca sul pulsante "Avanti" per iniziare il Compito 2.
    {% else %}
      When you are ready to begin, click the "Next" button to proceed to Task 2.
    {% endif %}
  </p>
  <div class="d-flex justify-content-end">
    <button type="submit" class="btn btn-primary btn-lg otree-btn-next">
      {% if player.selected_language == 'it' %} Avanti {% else %} Next {% endif %}
    </button>
  </div>
{% endblock %}

{% block scripts %}
  <script>
    document.querySelector('.otree-btn-next').addEventListener('click', function(e) {
      const answer = document.getElementById('check_task2').value.trim();
      const errorBox = document.getElementById('task2-error');
      if (answer !== '600') {
        e.preventDefault();
        errorBox.style.display = 'block';
        document.getElementById('check_task2').classList.add('is-invalid');
      } else {
        errorBox.style.display = 'none';
        document.getElementById('check_task2').classList.remove('is-invalid');
      }
    });
  </script>
{% endblock %}
